# Chapter 32: What are Subroutines?

## **32.1 Introduction**
In programming, a **subroutine** is a block of reusable code designed to perform a specific task. Subroutines allow you to organize your program into smaller, manageable parts, making your code easier to read, debug, and maintain. In QBasic, subroutines can be defined using the `SUB` and `END SUB` keywords.

This chapter introduces the concept of subroutines, explains their syntax, and provides examples of how to use them effectively.

---

## **32.2 Why Use Subroutines?**

Subroutines offer several benefits:
1. **Code Reusability**: Write once, use multiple times.
2. **Improved Readability**: Divide large programs into smaller, logical sections.
3. **Easier Debugging**: Isolate and test specific functionality.
4. **Modular Programming**: Encourage the use of independent code blocks for better structure.

---

## **32.3 Syntax of Subroutines**

### **32.3.1 Declaring a Subroutine**
A subroutine begins with the `SUB` keyword and ends with `END SUB`. The subroutineâ€™s name must be unique and follow the naming rules of QBasic.

#### **Syntax**
```basic
SUB subroutineName
    ' Code to execute
END SUB
```

- **`subroutineName`**: The name of the subroutine.

---

### **32.3.2 Calling a Subroutine**
To execute a subroutine, use the `CALL` keyword followed by the subroutine name.

#### **Syntax**
```basic
CALL subroutineName
```

---

## **32.4 Examples of Subroutines**

### **32.4.1 A Simple Subroutine**
#### **Example: Displaying a Message**
```basic
SUB DisplayMessage
    PRINT "Welcome to QBasic Subroutines!"
END SUB

CALL DisplayMessage
```

**Output:**
```
Welcome to QBasic Subroutines!
```

---

### **32.4.2 Subroutine with Parameters**
Subroutines can accept parameters to perform specific tasks dynamically.

#### **Syntax**
```basic
SUB subroutineName(parameter1, parameter2, ...)
    ' Code to execute using parameters
END SUB
```

#### **Example: Adding Two Numbers**
```basic
SUB AddNumbers(a, b)
    PRINT "The sum is: "; a + b
END SUB

CALL AddNumbers(5, 10)
```

**Output:**
```
The sum is: 15
```

---

### **32.4.3 Subroutine Without `CALL`**
In QBasic, calling a subroutine without the `CALL` keyword is also valid.

#### **Example**
```basic
SUB GreetUser
    PRINT "Hello, User!"
END SUB

GreetUser
```

**Output:**
```
Hello, User!
```

---

## **32.5 Subroutines with Parameters and Logic**

### **Example: Checking Even or Odd**
```basic
SUB CheckEvenOdd(number)
    IF number MOD 2 = 0 THEN
        PRINT number; " is even."
    ELSE
        PRINT number; " is odd."
    END IF
END SUB

CALL CheckEvenOdd(7)
CALL CheckEvenOdd(4)
```

**Output:**
```
7 is odd.
4 is even.
```

---

## **32.6 Reusing Subroutines**

Subroutines can be reused multiple times within a program, reducing redundancy.

### **Example: Calculating Square and Cube**
```basic
SUB CalculateSquare(num)
    PRINT "Square of "; num; " is "; num * num
END SUB

SUB CalculateCube(num)
    PRINT "Cube of "; num; " is "; num * num * num
END SUB

CALL CalculateSquare(3)
CALL CalculateCube(3)
CALL CalculateSquare(5)
CALL CalculateCube(5)
```

**Output:**
```
Square of 3 is 9
Cube of 3 is 27
Square of 5 is 25
Cube of 5 is 125
```

---

## **32.7 Passing Multiple Parameters**

Subroutines can accept multiple parameters, making them more flexible.

### **Example: Calculating Area and Perimeter**
```basic
SUB CalculateRectangle(length, width)
    PRINT "Area: "; length * width
    PRINT "Perimeter: "; 2 * (length + width)
END SUB

CALL CalculateRectangle(5, 3)
```

**Output:**
```
Area: 15
Perimeter: 16
```

---

## **32.8 Common Errors with Subroutines**

1. **Mismatched Parameters:**
   - Ensure the number and order of parameters match between the subroutine definition and the `CALL` statement.
   ```basic
   CALL AddNumbers(5)  ' Error: Missing one parameter
   ```

2. **Name Conflicts:**
   - Avoid using the same name for subroutines and variables.

3. **Unnecessary Calls:**
   - Ensure subroutines are called only when needed to avoid redundant operations.

---

## **32.9 Best Practices for Subroutines**

1. **Use Descriptive Names:**
   - Name subroutines based on their functionality.
   ```basic
   SUB CalculateInterest
   ```

2. **Limit Parameters:**
   - Pass only the necessary data to keep subroutines simple.

3. **Keep Subroutines Focused:**
   - Design each subroutine to perform one specific task.

4. **Document Your Code:**
   - Add comments to explain the purpose and parameters of the subroutine.
   ```basic
   ' This subroutine calculates the square of a number
   ```

5. **Test Subroutines Independently:**
   - Verify subroutines work correctly before integrating them into the main program.

---

## **32.10 Applications of Subroutines**

### **32.10.1 Modularizing Programs**
Split large programs into smaller, logical sections using subroutines.

#### **Example: A Simple Calculator**
```basic
SUB Add(a, b)
    PRINT "Sum: "; a + b
END SUB

SUB Subtract(a, b)
    PRINT "Difference: "; a - b
END SUB

SUB Multiply(a, b)
    PRINT "Product: "; a * b
END SUB

SUB Divide(a, b)
    IF b <> 0 THEN
        PRINT "Quotient: "; a / b
    ELSE
        PRINT "Division by zero is not allowed."
    END IF
END SUB

CALL Add(10, 5)
CALL Subtract(10, 5)
CALL Multiply(10, 5)
CALL Divide(10, 5)
CALL Divide(10, 0)
```

**Output:**
```
Sum: 15
Difference: 5
Product: 50
Quotient: 2
Division by zero is not allowed.
```

---

## **32.11 Summary**
Subroutines are a powerful tool in QBasic for organizing code into reusable, modular blocks. By using `SUB` and `END SUB`, you can create self-contained sections of code that perform specific tasks. Subroutines improve code readability, reduce redundancy, and make debugging easier. Understanding and mastering subroutines is essential for writing efficient and well-structured programs.

In the next chapter, we will explore **functions**, another way to organize reusable code in QBasic, which also return values.
