# What are Subroutines?

## **32.1 Introduction**
In programming, a **subroutine** is a reusable block of code that performs a specific task. Subroutines make your programs more modular, improving readability and efficiency. In QBasic, subroutines are defined using the `SUB` and `END SUB` keywords and can be called from other parts of your program.

This chapter explains the syntax and usage of subroutines in QBasic, along with examples structured in a modular format.

---

## **32.2 Syntax of Subroutines**

### **32.2.1 Defining a Subroutine**
A subroutine is defined using the `SUB` keyword and ends with `END SUB`. You can pass data to a subroutine using parameters.

#### **Syntax**
```basic
SUB SubroutineName (parameter1, parameter2, ...)
    ' Code for the subroutine
END SUB
```

---

### **32.2.2 Calling a Subroutine**
To execute a subroutine, use the `CALL` keyword followed by the subroutine name and arguments.

#### **Syntax**
```basic
CALL SubroutineName(arguments)
```

---

## **32.3 Examples of Subroutines**

### **32.3.1 A Simple Subroutine**
#### **Example: Displaying a Message**
```basic
SUB MAIN
    CALL DisplayMessage
END SUB

SUB DisplayMessage
    PRINT "Welcome to QBasic Subroutines!"
END SUB
```

**Output:**
```
Welcome to QBasic Subroutines!
```

---

### **32.3.2 Subroutine with Parameters**
Subroutines can accept parameters to perform specific tasks dynamically.

#### **Example: Adding Two Numbers**
```basic
SUB MAIN
    CALL AddNumbers(5, 10)
END SUB

SUB AddNumbers(a, b)
    PRINT "The sum is: "; a + b
END SUB
```

**Output:**
```
The sum is: 15
```

---

### **32.3.3 Modular Code Using Subroutines**
Subroutines can be used to organize your program into logical sections.

#### **Example: Calculating Rectangle Area and Perimeter**
```basic
SUB MAIN
    CALL CalculateRectangle(5, 10)
END SUB

SUB CalculateRectangle(length, width)
    PRINT "Area: "; length * width
    PRINT "Perimeter: "; 2 * (length + width)
END SUB
```

**Output:**
```
Area: 50
Perimeter: 30
```

---

## **32.4 Using Subroutines with Logic**

### **Example: Checking Even or Odd**
```basic
SUB MAIN
    CALL CheckEvenOdd(7)
    CALL CheckEvenOdd(4)
END SUB

SUB CheckEvenOdd(number)
    IF number MOD 2 = 0 THEN
        PRINT number; " is even."
    ELSE
        PRINT number; " is odd."
    END IF
END SUB
```

**Output:**
```
7 is odd.
4 is even.
```

---

## **32.5 Reusing Subroutines**

### **Example: Calculating Square and Cube**
```basic
SUB MAIN
    CALL CalculateSquare(3)
    CALL CalculateCube(3)
    CALL CalculateSquare(5)
    CALL CalculateCube(5)
END SUB

SUB CalculateSquare(num)
    PRINT "Square of "; num; " is "; num * num
END SUB

SUB CalculateCube(num)
    PRINT "Cube of "; num; " is "; num * num * num
END SUB
```

**Output:**
```
Square of 3 is 9
Cube of 3 is 27
Square of 5 is 25
Cube of 5 is 125
```

---

## **32.6 Passing Multiple Parameters**

### **Example: Dynamic Calculations**
```basic
SUB MAIN
    CALL CalculateValues(8, 12)
END SUB

SUB CalculateValues(a, b)
    PRINT "Sum: "; a + b
    PRINT "Difference: "; a - b
    PRINT "Product: "; a * b
    IF b <> 0 THEN
        PRINT "Quotient: "; a / b
    ELSE
        PRINT "Division by zero is not allowed."
    END IF
END SUB
```

**Output:**
```
Sum: 20
Difference: -4
Product: 96
Quotient: 0.6666667
```

---

## **32.7 Common Errors with Subroutines**

1. **Mismatched Parameters:**
   - Ensure the number and order of parameters match between the `CALL` statement and the subroutine definition.
   ```basic
   CALL AddNumbers(5)  ' Error: Missing one parameter
   ```

2. **Name Conflicts:**
   - Avoid using the same name for subroutines and variables.

3. **Unnecessary Calls:**
   - Ensure subroutines are called only when needed to avoid redundant operations.

---

## **32.8 Best Practices for Subroutines**

1. **Use Descriptive Names:**
   - Name subroutines based on their functionality.
   ```basic
   SUB CalculateInterest
   ```

2. **Limit Parameters:**
   - Pass only the necessary data to keep subroutines simple.

3. **Keep Subroutines Focused:**
   - Design each subroutine to perform one specific task.

4. **Document Your Code:**
   - Add comments to explain the purpose and parameters of the subroutine.
   ```basic
   ' This subroutine calculates the square of a number
   ```

5. **Test Subroutines Independently:**
   - Verify subroutines work correctly before integrating them into the main program.

---

## **32.9 Applications of Subroutines**

### **Example: A Simple Calculator**
```basic
SUB MAIN
    CALL Add(10, 5)
    CALL Subtract(10, 5)
    CALL Multiply(10, 5)
    CALL Divide(10, 5)
    CALL Divide(10, 0)
END SUB

SUB Add(a, b)
    PRINT "Sum: "; a + b
END SUB

SUB Subtract(a, b)
    PRINT "Difference: "; a - b
END SUB

SUB Multiply(a, b)
    PRINT "Product: "; a * b
END SUB

SUB Divide(a, b)
    IF b <> 0 THEN
        PRINT "Quotient: "; a / b
    ELSE
        PRINT "Division by zero is not allowed."
    END IF
END SUB
```

**Output:**
```
Sum: 15
Difference: 5
Product: 50
Quotient: 2
Division by zero is not allowed.
```

---

## **32.10 Summary**
Subroutines are a fundamental concept in QBasic that enable you to write modular, reusable, and organized code. By defining and calling subroutines, you can break down complex programs into manageable pieces. With parameters, subroutines become versatile tools for dynamic computations. Mastering subroutines will help you write efficient and well-structured programs.
