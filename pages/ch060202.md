# Writing Your Own Functions

## **35.1 Introduction**
In addition to using built-in functions, QBasic allows you to create your own custom functions. These user-defined functions enable you to perform specific tasks and return a value to the main program. They improve code reusability and make your programs more modular and efficient.

This chapter explores how to write and use your own functions in QBasic.

---

## **35.2 What is a User-Defined Function?**
A **user-defined function** is a reusable block of code that performs a specific operation and returns a result. Unlike subroutines, functions always return a value and can be used directly in expressions.

---

## **35.3 Declaring a Function**
User-defined functions in QBasic are declared using the `FUNCTION` and `END FUNCTION` keywords.

### **Syntax**
```basic
FUNCTION functionName (parameter1, parameter2, ...)
    ' Function logic
    functionName = result
END FUNCTION
```

- **`functionName`**: The name of the function.
- **`parameter1, parameter2, ...`**: Optional parameters passed to the function.
- **`functionName = result`**: Assigns the computed result to the function name, which will be returned to the caller.

---

## **35.4 Calling a Function**
You can call a user-defined function by using its name and providing the required arguments.

### **Syntax**
```basic
result = functionName(arguments)
```

---

## **35.5 Examples of User-Defined Functions**

### **35.5.1 Simple Function**
#### **Example: Calculating the Square of a Number**
```basic
FUNCTION Square(num)
    Square = num * num
END FUNCTION

PRINT "The square of 5 is: "; Square(5)
```

**Output:**
```
The square of 5 is: 25
```

---

### **35.5.2 Function with Multiple Parameters**
#### **Example: Calculating the Area of a Rectangle**
```basic
FUNCTION RectangleArea(length, width)
    RectangleArea = length * width
END FUNCTION

PRINT "The area of the rectangle is: "; RectangleArea(5, 10)
```

**Output:**
```
The area of the rectangle is: 50
```

---

### **35.5.3 Function for Factorial**
#### **Example: Calculating the Factorial of a Number**
```basic
FUNCTION Factorial(n)
    DIM result AS LONG
    result = 1

    FOR i = 1 TO n
        result = result * i
    NEXT i

    Factorial = result
END FUNCTION

PRINT "The factorial of 5 is: "; Factorial(5)
```

**Output:**
```
The factorial of 5 is: 120
```

---

### **35.5.4 Function with Conditional Logic**
#### **Example: Checking if a Number is Prime**
```basic
FUNCTION IsPrime(n)
    IF n < 2 THEN
        IsPrime = 0
        EXIT FUNCTION
    END IF

    FOR i = 2 TO INT(SQR(n))
        IF n MOD i = 0 THEN
            IsPrime = 0
            EXIT FUNCTION
        END IF
    NEXT i

    IsPrime = 1
END FUNCTION

DIM num AS INTEGER
num = 7
IF IsPrime(num) THEN
    PRINT num; " is a prime number."
ELSE
    PRINT num; " is not a prime number."
END IF
```

**Output:**
```
7 is a prime number.
```

---

## **35.6 Using Functions in Expressions**
You can directly use functions within expressions or combine them with other functions and operators.

### **Example: Calculating the Hypotenuse**
```basic
FUNCTION Hypotenuse(a, b)
    Hypotenuse = SQR(a * a + b * b)
END FUNCTION

PRINT "The hypotenuse is: "; Hypotenuse(3, 4)
```

**Output:**
```
The hypotenuse is: 5
```

---

## **35.7 Practical Applications of User-Defined Functions**

### **35.7.1 Validating User Input**
#### **Example: Checking if a Number is Positive**
```basic
FUNCTION IsPositive(num)
    IsPositive = (num > 0)
END FUNCTION

DIM value AS INTEGER
INPUT "Enter a number: ", value

IF IsPositive(value) THEN
    PRINT value; " is positive."
ELSE
    PRINT value; " is not positive."
END IF
```

**Input:**
```
Enter a number: -5
```

**Output:**
```
-5 is not positive.
```

---

### **35.7.2 String Manipulation**
#### **Example: Reversing a String**
```basic
FUNCTION ReverseString(text$)
    DIM reversed$ AS STRING
    reversed$ = ""

    FOR i = LEN(text$) TO 1 STEP -1
        reversed$ = reversed$ + MID$(text$, i, 1)
    NEXT i

    ReverseString = reversed$
END FUNCTION

PRINT "The reverse of 'QBasic' is: "; ReverseString("QBasic")
```

**Output:**
```
The reverse of 'QBasic' is: cisaBQ
```

---

## **35.8 Common Errors with User-Defined Functions**

1. **Forgetting to Return a Value:**
   - Always assign a result to the function name.
   ```basic
   FUNCTION Add(a, b)
       ' Missing Add = a + b
   END FUNCTION
   ```

2. **Mismatched Parameters:**
   - Ensure the number of arguments passed matches the function definition.
   ```basic
   PRINT Add(5)  ' Error: Missing second parameter
   ```

3. **Infinite Recursion:**
   - Avoid functions that call themselves without a proper exit condition.

---

## **35.9 Best Practices for User-Defined Functions**

1. **Use Descriptive Names:**
   - Name functions based on their purpose.
   ```basic
   FUNCTION CalculateInterest(principal, rate, time)
   ```

2. **Keep Functions Simple:**
   - Ensure each function performs a single task.

3. **Validate Input:**
   - Check for invalid or unexpected inputs within the function.

4. **Document Functions:**
   - Add comments explaining the function's purpose and parameters.
   ```basic
   ' Function to calculate the area of a rectangle
   ```

5. **Test Functions Independently:**
   - Verify the function works as expected before integrating it into the main program.

---

## **35.10 Summary**
User-defined functions in QBasic enable you to create reusable code blocks tailored to specific tasks. By using the `FUNCTION` keyword, you can define functions that accept parameters, perform operations, and return values. Functions enhance program modularity, readability, and maintainability.

