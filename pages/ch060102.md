# Writing and Calling Subroutines

## **33.1 Introduction**
Subroutines are reusable blocks of code designed to perform specific tasks in a program. They help structure your code into smaller, more manageable pieces, making it easier to read, debug, and maintain. In environments that use QBasic, subroutines are implemented using the `GOSUB` and `RETURN` keywords.

This chapter focuses on how to write and call subroutines using `GOSUB` and demonstrates their practical applications.

---

## **33.2 What Are Subroutines?**
A subroutine is a labeled section of code that performs a specific task. You can call this subroutine from anywhere in the program, execute its code, and return to the next statement after the call.

---

## **33.3 Writing Subroutines**
Subroutines in QBasic are defined using a label followed by the code for the task. The subroutine ends with a `RETURN` statement, which sends control back to the calling point.

### **Syntax**
```basic
label:
    ' Code for the subroutine
    RETURN
```

---

## **33.4 Calling Subroutines**
To execute a subroutine, use the `GOSUB` statement with the label of the subroutine.

### **Syntax**
```basic
GOSUB label
```

- The program jumps to the subroutine's label, executes its code, and returns to the line following the `GOSUB` call.

---

## **33.5 Examples of Writing and Calling Subroutines**

### **33.5.1 Simple Subroutine**
#### **Example: Displaying a Welcome Message**
```basic
PRINT "Program Start"
GOSUB DisplayMessage
PRINT "Program End"
END

DisplayMessage:
    PRINT "Welcome to Subroutines in QBasic!"
    RETURN
```

**Output:**
```
Program Start
Welcome to Subroutines in QBasic!
Program End
```

---

### **33.5.2 Subroutine with Variables**
Variables can be used within subroutines to perform calculations or display information.

#### **Example: Adding Two Numbers**
```basic
DIM a AS INTEGER, b AS INTEGER

a = 5
b = 10

PRINT "Program Start"
GOSUB AddNumbers
PRINT "Program End"
END

AddNumbers:
    PRINT "The sum is: "; a + b
    RETURN
```

**Output:**
```
Program Start
The sum is: 15
Program End
```

---

### **33.5.3 Reusing Subroutines**
You can call a subroutine multiple times from different parts of the program.

#### **Example: Calculating Area and Perimeter**
```basic
DIM length AS INTEGER, width AS INTEGER

length = 5
width = 10
GOSUB CalculateRectangle

length = 8
width = 4
GOSUB CalculateRectangle

END

CalculateRectangle:
    PRINT "Length: "; length
    PRINT "Width: "; width
    PRINT "Area: "; length * width
    PRINT "Perimeter: "; 2 * (length + width)
    RETURN
```

**Output:**
```
Length: 5
Width: 10
Area: 50
Perimeter: 30
Length: 8
Width: 4
Area: 32
Perimeter: 24
```

---

## **33.6 Passing Data to Subroutines**
Subroutines do not have direct parameters, but you can use variables to pass data indirectly.

#### **Example: Checking Even or Odd**
```basic
DIM number AS INTEGER

number = 7
GOSUB CheckEvenOdd

number = 4
GOSUB CheckEvenOdd
END

CheckEvenOdd:
    IF number MOD 2 = 0 THEN
        PRINT number; " is even."
    ELSE
        PRINT number; " is odd."
    END IF
    RETURN
```

**Output:**
```
7 is odd.
4 is even.
```

---

## **33.7 Practical Applications of Subroutines**

### **33.7.1 Dynamic Calculations**
#### **Example: Basic Arithmetic Operations**
```basic
DIM a AS INTEGER, b AS INTEGER

a = 12
b = 8
GOSUB Add
GOSUB Subtract
GOSUB Multiply
GOSUB Divide

END

Add:
    PRINT "Sum: "; a + b
    RETURN

Subtract:
    PRINT "Difference: "; a - b
    RETURN

Multiply:
    PRINT "Product: "; a * b
    RETURN

Divide:
    IF b <> 0 THEN
        PRINT "Quotient: "; a / b
    ELSE
        PRINT "Division by zero is not allowed."
    END IF
    RETURN
```

**Output:**
```
Sum: 20
Difference: 4
Product: 96
Quotient: 1.5
```

---

### **33.7.2 Validating Input**
#### **Example: Checking for a Positive Number**
```basic
DIM number AS INTEGER

INPUT "Enter a number: ", number
GOSUB ValidatePositive
END

ValidatePositive:
    IF number > 0 THEN
        PRINT number; " is positive."
    ELSE
        PRINT number; " is not positive."
    END IF
    RETURN
```

**Input:**
```
Enter a number: -5
```

**Output:**
```
-5 is not positive.
```

---

### **33.7.3 Dynamic Message Display**
#### **Example: Greeting the User**
```basic
DIM name AS STRING

INPUT "Enter your name: ", name
GOSUB GreetUser
END

GreetUser:
    PRINT "Hello, "; name; "! Welcome to QBasic."
    RETURN
```

**Input:**
```
Enter your name: Alice
```

**Output:**
```
Hello, Alice! Welcome to QBasic.
```

---

## **33.8 Best Practices for Writing Subroutines**

1. **Use Descriptive Labels:**
   - Name subroutines to reflect their purpose.
   ```basic
   CalculateArea:
   ```

2. **Document Subroutines:**
   - Add comments to describe the subroutine's purpose.
   ```basic
   ' This subroutine calculates the rectangle's area and perimeter
   ```

3. **Keep Subroutines Focused:**
   - Ensure each subroutine performs a single, well-defined task.

4. **Limit Global Variables:**
   - Use variables judiciously to avoid conflicts between subroutines.

5. **Reuse Subroutines:**
   - Call subroutines multiple times to reduce code duplication.

---

## **33.9 Common Errors with Subroutines**

1. **Missing `RETURN`:**
   - Always end a subroutine with `RETURN` to avoid errors.
   ```basic
   SubroutineName:
       PRINT "Task"
       ' Missing RETURN
   ```

2. **Undefined Labels:**
   - Ensure the label used in `GOSUB` matches the subroutine's label.

3. **Variable Conflicts:**
   - Avoid using the same variable names across different subroutines unless intended.

---

## **33.10 Summary**
Subroutines in QBasic are a powerful way to organize code into reusable blocks. Using `GOSUB` and `RETURN`, you can write modular programs that are easier to read, debug, and maintain. By structuring your code into logical subroutines, you can simplify complex tasks, improve reusability, and enhance program efficiency.


